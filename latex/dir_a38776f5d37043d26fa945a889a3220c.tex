\doxysection{arkanjo/third-\/party/duplicate-\/code-\/detection-\/tool Directory Reference}
\hypertarget{dir_a38776f5d37043d26fa945a889a3220c}{}\label{dir_a38776f5d37043d26fa945a889a3220c}\index{arkanjo/third-\/party/duplicate-\/code-\/detection-\/tool Directory Reference@{arkanjo/third-\/party/duplicate-\/code-\/detection-\/tool Directory Reference}}
Directory dependency graph for duplicate-\/code-\/detection-\/tool\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=252pt]{dir_a38776f5d37043d26fa945a889a3220c_dep}
\end{center}
\end{figure}
\doxysubsubsection*{Files}
\begin{DoxyCompactItemize}
\item 
file \mbox{\hyperlink{duplicate__code__detection_8py}{duplicate\+\_\+code\+\_\+detection.\+py}}
\begin{DoxyCompactList}\small\item\em A simple Python3 tool to detect similarities between files within a repository. \end{DoxyCompactList}\item 
file \mbox{\hyperlink{run__action_8py}{run\+\_\+action.\+py}}
\item 
file \mbox{\hyperlink{setup_8py}{setup.\+py}}
\begin{DoxyCompactList}\small\item\em Package configuration for duplicate code detection tool. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
A simple Python3 tool (also available as a Git\+Hub Action) to detect similarities between files within a repository.\hypertarget{README.md_autotoc_md11}{}\doxysubsection{\texorpdfstring{What?}{What?}}\label{README.md_autotoc_md11}
A command line tool that receives a directory or a list of files and determines the degree of similarity between them.\hypertarget{README.md_autotoc_md12}{}\doxysubsection{\texorpdfstring{Why?}{Why?}}\label{README.md_autotoc_md12}
The tool intends guide the refactoring efforts of a developer who wishes to reduce code duplication within a component and improve its software architecture.

Its development was initiated within the context of the \href{https://pingpong.chalmers.se/public/courseId/9754/lang-en/publicPage.do}{\texttt{ DAT265 -\/ Software Evolution Project}}.\hypertarget{README.md_autotoc_md13}{}\doxysubsection{\texorpdfstring{How?}{How?}}\label{README.md_autotoc_md13}
The tool uses the \href{https://radimrehurek.com/gensim/}{\texttt{ gensim}} Python library to determine the similarity between source code files, supplied by the user. The default supported languages are C, C++, JAVA, Python and C\#.\hypertarget{README.md_autotoc_md14}{}\doxysubsubsection{\texorpdfstring{Dependencies}{Dependencies}}\label{README.md_autotoc_md14}
The following Python packages have to be installed\+:
\begin{DoxyItemize}
\item nltk
\begin{DoxyItemize}
\item {\ttfamily pip3 install -\/-\/user nltk}
\end{DoxyItemize}
\item gensim
\begin{DoxyItemize}
\item {\ttfamily pip3 install -\/-\/user gensim}
\end{DoxyItemize}
\item astor
\begin{DoxyItemize}
\item {\ttfamily pip3 install -\/-\/user astor}
\end{DoxyItemize}
\item punkt
\begin{DoxyItemize}
\item {\ttfamily python3 -\/m nltk.\+downloader punkt}
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{README.md_autotoc_md15}{}\doxysubsection{\texorpdfstring{Get started}{Get started}}\label{README.md_autotoc_md15}
Suppress the warnings (generated by the used libraries) as {\ttfamily python3 -\/W ignore \doxylink{duplicate__code__detection_8py}{duplicate\+\_\+code\+\_\+detection.\+py}} and then supply the necessary arguments. More details can be found by running the tool with the {\ttfamily -\/-\/help} option.

{\bfseries{Notice\+:}} Due to the way the models are created, the more source files you provide the tool the more accurate the similarity calculations are. In other words, the bigger the project, the more useful the tool is.\hypertarget{README.md_autotoc_md16}{}\doxysubsubsection{\texorpdfstring{Example}{Example}}\label{README.md_autotoc_md16}
If {\ttfamily duplicate-\/code-\/detection-\/tool} is the name where the tool resides in and {\ttfamily smartcar\+\_\+shield/src} contains the repository you want to check for source code similarities between the files, then you can run the following to get the similarity report\+:

{\ttfamily python3 -\/W ignore \doxylink{duplicate__code__detection_8py}{duplicate-\/code-\/detection-\/tool/duplicate\+\_\+code\+\_\+detection.\+py} -\/d smartcar\+\_\+shield/src/}

The result should look something like this\+:

\hypertarget{README.md_autotoc_md17}{}\doxysubsection{\texorpdfstring{Git\+Hub Action}{Git\+Hub Action}}\label{README.md_autotoc_md17}
The tool is also available as a \href{https://docs.github.com/en/actions}{\texttt{ Git\+Hub Action}} for easy integration with projects hosted on Git\+Hub. An example output of the tool can be seen \href{https://github.com/platisd/smartcar_shield/pull/36\#issuecomment-778635111}{\texttt{ here}}.

The Action is meant to be triggered during {\bfseries{pull requests}} to give the developers an impression over the {\bfseries{degree of similarity}} between the files in the source code. Below you will find a sample workflow files that illustrate the usage.

Depending on the {\itshape size} of your project, you may want to have the tool running multiple times (i.\+e in diffferent steps) that test specific parts of your repository for duplicate code. This way you will not compare each file in your codebase with everything else and get back more meaningful reports.\hypertarget{README.md_autotoc_md18}{}\doxysubsubsection{\texorpdfstring{Bare minimum}{Bare minimum}}\label{README.md_autotoc_md18}
In the following example the tool will examine source code (the languages supported by default) in the {\ttfamily src/} and {\ttfamily test/ut} directories {\itshape relative} to the root directory of your repository. The results will be posted as a comment in the {\bfseries{pull request}} that was opened.


\begin{DoxyCode}{0}
\DoxyCodeLine{name:\ Duplicate\ code}
\DoxyCodeLine{}
\DoxyCodeLine{on:\ pull\_request}
\DoxyCodeLine{}
\DoxyCodeLine{jobs:}
\DoxyCodeLine{\ \ duplicate-\/code-\/check:}
\DoxyCodeLine{\ \ \ \ name:\ Check\ for\ duplicate\ code}
\DoxyCodeLine{\ \ \ \ runs-\/on:\ ubuntu-\/20.04}
\DoxyCodeLine{\ \ \ \ steps:}
\DoxyCodeLine{\ \ \ \ \ \ -\/\ name:\ Check\ for\ duplicate\ code}
\DoxyCodeLine{\ \ \ \ \ \ \ \ uses:\ platisd/duplicate-\/code-\/detection-\/tool@master}
\DoxyCodeLine{\ \ \ \ \ \ \ \ with:}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ github\_token:\ \$\{\{\ secrets.GITHUB\_TOKEN\ \}\}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ directories:\ "{}src/,\ test/ut"{}}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md19}{}\doxysubsubsection{\texorpdfstring{Trigger on pull request comment}{Trigger on pull request comment}}\label{README.md_autotoc_md19}
If you want to avoid the "{}spam"{} you should configure the tool to not always run. Specifically, if you wish to trigger the Action manually, you can do so by leaving a comment in the pull request.

The following action will trigger the tool to be run when a comment containig {\ttfamily run\+\_\+duplicate\+\_\+code\+\_\+detection\+\_\+tool} is posted in a pull request. The tool will run using the code in the pull request.


\begin{DoxyCode}{0}
\DoxyCodeLine{name:\ Duplicate\ code}
\DoxyCodeLine{}
\DoxyCodeLine{on:\ issue\_comment}
\DoxyCodeLine{}
\DoxyCodeLine{jobs:}
\DoxyCodeLine{\ \ duplicate-\/code-\/check:}
\DoxyCodeLine{\ \ \ \ name:\ Check\ for\ duplicate\ code}
\DoxyCodeLine{\ \ \ \ \#\ Trigger\ the\ tool\ only\ when\ a\ comment\ containing\ the\ keyword\ is\ published\ in\ a\ pull\ request}
\DoxyCodeLine{\ \ \ \ if:\ github.event.issue.pull\_request\ \&\&\ contains(github.event.comment.body,\ 'run\_duplicate\_code\_detection\_tool')}
\DoxyCodeLine{\ \ \ \ runs-\/on:\ ubuntu-\/20.04}
\DoxyCodeLine{\ \ \ \ steps:}
\DoxyCodeLine{\ \ \ \ \ \ -\/\ name:\ Check\ for\ duplicate\ code}
\DoxyCodeLine{\ \ \ \ \ \ \ \ uses:\ platisd/duplicate-\/code-\/detection-\/tool@master}
\DoxyCodeLine{\ \ \ \ \ \ \ \ with:}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ github\_token:\ \$\{\{\ secrets.GITHUB\_TOKEN\ \}\}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ directories:\ "{}."{}}

\end{DoxyCode}


{\bfseries{Important\+:}} Please note that due to the way Git\+Hub Actions work, you will {\itshape first} have to merge this into your main branch so it starts taking effect.\hypertarget{README.md_autotoc_md20}{}\doxysubsubsection{\texorpdfstring{Optional configuration}{Optional configuration}}\label{README.md_autotoc_md20}
It may not make sense to compare all files or get a files with very low similarity reported. In the following workflow, the different {\itshape optional} arguments are demonstrated.

For the various default values, please consult \href{action.yml}{\texttt{ action.\+yml}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{name:\ Duplicate\ code}
\DoxyCodeLine{}
\DoxyCodeLine{on:\ pull\_request}
\DoxyCodeLine{}
\DoxyCodeLine{jobs:}
\DoxyCodeLine{\ \ duplicate-\/code-\/check:}
\DoxyCodeLine{\ \ \ \ name:\ Check\ for\ duplicate\ code}
\DoxyCodeLine{\ \ \ \ runs-\/on:\ ubuntu-\/20.04}
\DoxyCodeLine{\ \ \ \ steps:}
\DoxyCodeLine{\ \ \ \ \ \ -\/\ name:\ Check\ for\ duplicate\ code}
\DoxyCodeLine{\ \ \ \ \ \ \ \ uses:\ platisd/duplicate-\/code-\/detection-\/tool@master}
\DoxyCodeLine{\ \ \ \ \ \ \ \ with:}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ github\_token:\ \$\{\{\ secrets.GITHUB\_TOKEN\ \}\}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ directories:\ "{}src"{}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \#\ Ignore\ the\ specified\ directories}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ ignore\_directories:\ "{}src/external\_libraries"{}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \#\ Only\ examine\ .h\ and\ .cpp\ files}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ file\_extensions:\ "{}h,\ cpp"{}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \#\ Only\ report\ similarities\ above\ 5\%}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ ignore\_below:\ 5}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \#\ If\ a\ file\ is\ more\ than\ 70\%\ similar\ to\ another,\ then\ the\ job\ fails}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ fail\_above:\ 70}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \#\ If\ a\ file\ is\ more\ than\ 15\%\ similar\ to\ another,\ show\ a\ warning\ symbol\ in\ the\ report}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ warn\_above:\ 15}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \#\ Remove\ \`{}src/`\ from\ the\ file\ paths\ when\ reporting\ similarities}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ project\_root\_dir:\ "{}src"{}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \#\ Remove\ docstrings\ from\ code\ before\ analysis}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \#\ For\ python\ source\ code\ only.\ This\ is\ checked\ on\ a\ per-\/file\ basis}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ only\_code:\ true}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \#\ Leave\ only\ one\ comment\ with\ the\ report\ and\ update\ it\ for\ consecutive\ runs}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ one\_comment:\ true}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \#\ The\ message\ to\ be\ displayed\ at\ the\ start\ of\ the\ report}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ header\_message\_start:\ "{}The\ following\ files\ have\ a\ similarity\ above\ the\ threshold:"{}}

\end{DoxyCode}
 \hypertarget{README.md_autotoc_md21}{}\doxysubsection{\texorpdfstring{Using duplicate-\/code-\/check with pre-\/commit}{Using duplicate-\/code-\/check with pre-\/commit}}\label{README.md_autotoc_md21}
To use Duplicate Code Detection Tool as a pre-\/commit hook with \href{https://pre-commit.com/}{\texttt{ pre-\/commit}} add the following to your {\ttfamily .pre-\/commit-\/config.\+yaml} file\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{-\/\ \ \ repo:\ https://github.com/platisd/duplicate-\/code-\/detection-\/tool.git}
\DoxyCodeLine{\ \ \ \ rev:\ ''\ \ \#\ Use\ the\ sha\ /\ tag\ you\ want\ to\ point\ at}
\DoxyCodeLine{\ \ \ \ hooks:}
\DoxyCodeLine{\ \ \ \ -\/\ \ \ id:\ duplicate-\/code-\/detection}

\end{DoxyCode}
 \begin{quote}
\texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}\+\_\+\+NOTE\+:\+\_\+\texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*} that this repository sets args\+: {\ttfamily -\/f}, if you are configuring duplicate-\/code-\/detection-\/tool using args you\textquotesingle{}ll want to include either {\ttfamily -\/f} ({\ttfamily -\/-\/files}) or {\ttfamily -\/d} ({\ttfamily -\/-\/directories}). \end{quote}
\hypertarget{README.md_autotoc_md22}{}\doxysubsection{\texorpdfstring{Limitations}{Limitations}}\label{README.md_autotoc_md22}

\begin{DoxyItemize}
\item {\ttfamily only\+\_\+code} option only works with python files for now 
\end{DoxyItemize}
